<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ settings.get('event_name','CODE GRAND PRIX') }}</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root {
  --red: #E30022;
  --gold: #FFD700;
  --dark: #0A0A0F;
  --darker: #050508;
  --panel: #0F0F1A;
  --border: #1a1a2e;
  --glow: #E30022;
  --text: #E8E8F0;
  --muted: #666680;
  --green: #00FF88;
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }
body {
  background: var(--darker);
  color: var(--text);
  font-family: 'Rajdhani', sans-serif;
  font-size: 16px;
  overflow-x: hidden;
}

/* TRACK LINES BACKGROUND */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background: 
    repeating-linear-gradient(90deg, transparent, transparent 60px, rgba(227,0,34,0.03) 60px, rgba(227,0,34,0.03) 61px),
    repeating-linear-gradient(0deg, transparent, transparent 60px, rgba(227,0,34,0.03) 60px, rgba(227,0,34,0.03) 61px);
  pointer-events: none;
  z-index: 0;
}

/* NAV */
nav {
  position: fixed; top: 0; left: 0; right: 0; z-index: 100;
  display: flex; align-items: center; justify-content: space-between;
  padding: 1rem 3rem;
  background: rgba(5,5,8,0.9);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid rgba(227,0,34,0.3);
}
.nav-logo {
  font-family: 'Orbitron', monospace;
  font-weight: 900; font-size: 1.1rem;
  color: var(--red);
  letter-spacing: 3px;
  text-decoration: none;
}
.nav-logo span { color: var(--gold); }
.nav-links { display: flex; gap: 2rem; align-items: center; }
.nav-links a {
  color: var(--muted); text-decoration: none;
  font-weight: 600; font-size: 0.85rem; letter-spacing: 1px;
  text-transform: uppercase;
  transition: color 0.2s;
}
.nav-links a:hover { color: var(--text); }
.btn-nav {
  background: var(--red); color: white !important;
  padding: 0.5rem 1.5rem; border-radius: 2px;
  clip-path: polygon(6px 0%, 100% 0%, calc(100% - 6px) 100%, 0% 100%);
}
.btn-nav:hover { background: #ff1a3a !important; color: white !important; }

/* HERO */
.hero {
  min-height: 100vh;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  text-align: center; padding: 6rem 2rem 4rem;
  position: relative; overflow: hidden;
}
.hero-bg {
  position: absolute; inset: 0; z-index: 0;
  background: radial-gradient(ellipse 80% 60% at 50% 40%, rgba(227,0,34,0.12) 0%, transparent 70%);
}
.speed-lines {
  position: absolute; inset: 0; z-index: 0;
  overflow: hidden;
}
.speed-line {
  position: absolute;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(227,0,34,0.4), transparent);
  animation: speedLine 3s linear infinite;
  opacity: 0;
}
@keyframes speedLine {
  0% { transform: translateX(-100%); opacity: 0; }
  10% { opacity: 1; }
  90% { opacity: 1; }
  100% { transform: translateX(200%); opacity: 0; }
}
.hero-eyebrow {
  font-family: 'Share Tech Mono', monospace;
  color: var(--red); font-size: 0.8rem; letter-spacing: 5px;
  text-transform: uppercase; margin-bottom: 1.5rem;
  position: relative; z-index: 1;
  animation: fadeInUp 0.6s ease both;
}
.hero-title {
  font-family: 'Orbitron', monospace;
  font-weight: 900;
  font-size: clamp(3rem, 10vw, 7rem);
  line-height: 0.95;
  position: relative; z-index: 1;
  animation: fadeInUp 0.6s ease 0.1s both;
}
.hero-title .line1 { color: white; display: block; }
.hero-title .line2 {
  color: transparent;
  -webkit-text-stroke: 2px var(--red);
  display: block;
}
.hero-title .line3 { color: var(--gold); display: block; font-size: 0.55em; }
.hero-tagline {
  font-size: 1.3rem; color: var(--muted); margin-top: 2rem;
  font-weight: 300; letter-spacing: 2px;
  position: relative; z-index: 1;
  animation: fadeInUp 0.6s ease 0.2s both;
}
.hero-cta {
  display: flex; gap: 1.5rem; margin-top: 3rem; flex-wrap: wrap; justify-content: center;
  position: relative; z-index: 1;
  animation: fadeInUp 0.6s ease 0.3s both;
}
.btn-primary {
  background: var(--red); color: white;
  padding: 1rem 3rem; font-family: 'Orbitron', monospace;
  font-size: 0.85rem; font-weight: 700; letter-spacing: 2px;
  text-transform: uppercase; text-decoration: none;
  clip-path: polygon(12px 0%, 100% 0%, calc(100% - 12px) 100%, 0% 100%);
  transition: all 0.2s; border: none; cursor: pointer;
  position: relative; overflow: hidden;
}
.btn-primary::before {
  content: ''; position: absolute; inset: 0;
  background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
  transform: translateX(-100%); transition: transform 0.4s;
}
.btn-primary:hover::before { transform: translateX(100%); }
.btn-primary:hover { background: #ff1a3a; transform: translateY(-2px); box-shadow: 0 8px 30px rgba(227,0,34,0.5); }
.btn-secondary {
  background: transparent; color: var(--gold);
  padding: 1rem 3rem; font-family: 'Orbitron', monospace;
  font-size: 0.85rem; font-weight: 700; letter-spacing: 2px;
  text-transform: uppercase; text-decoration: none;
  clip-path: polygon(12px 0%, 100% 0%, calc(100% - 12px) 100%, 0% 100%);
  transition: all 0.2s; border: 2px solid var(--gold);
}
.btn-secondary:hover { background: rgba(255,215,0,0.1); transform: translateY(-2px); }

/* COUNTDOWN */
.countdown-section {
  position: relative; z-index: 1;
  margin-top: 3rem;
  animation: fadeInUp 0.6s ease 0.4s both;
}
.countdown-label {
  font-family: 'Share Tech Mono', monospace;
  color: var(--muted); font-size: 0.75rem; letter-spacing: 3px;
  text-transform: uppercase; margin-bottom: 1rem;
}
.countdown-timer {
  display: flex; gap: 1.5rem; justify-content: center;
}
.countdown-unit {
  text-align: center;
  background: rgba(227,0,34,0.1);
  border: 1px solid rgba(227,0,34,0.3);
  padding: 1rem 1.5rem;
  min-width: 80px;
}
.countdown-num {
  font-family: 'Orbitron', monospace;
  font-size: 2.5rem; font-weight: 900;
  color: var(--red); line-height: 1;
}
.countdown-unit-label {
  font-family: 'Share Tech Mono', monospace;
  font-size: 0.65rem; color: var(--muted); letter-spacing: 2px; margin-top: 0.3rem;
}

/* SECTIONS */
section {
  position: relative; z-index: 1;
  padding: 5rem 2rem;
  max-width: 1100px; margin: 0 auto;
}
.section-header {
  text-align: center; margin-bottom: 3rem;
}
.section-tag {
  font-family: 'Share Tech Mono', monospace;
  color: var(--red); font-size: 0.75rem; letter-spacing: 4px; text-transform: uppercase;
}
.section-title {
  font-family: 'Orbitron', monospace;
  font-size: 2rem; font-weight: 900;
  margin-top: 0.5rem;
}

/* RULES */
.rules-grid {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;
}
.rule-card {
  background: var(--panel);
  border: 1px solid var(--border);
  border-left: 3px solid var(--red);
  padding: 1.5rem;
  transition: border-color 0.2s, transform 0.2s;
}
.rule-card:hover { border-left-color: var(--gold); transform: translateX(4px); }
.rule-num {
  font-family: 'Orbitron', monospace; font-size: 0.7rem;
  color: var(--red); letter-spacing: 2px; margin-bottom: 0.5rem;
}
.rule-card h3 { font-size: 1rem; font-weight: 700; margin-bottom: 0.5rem; }
.rule-card p { color: var(--muted); font-size: 0.9rem; line-height: 1.6; }

/* SCHEDULE */
.timeline {
  position: relative;
  padding-left: 2rem;
}
.timeline::before {
  content: '';
  position: absolute; left: 0; top: 0; bottom: 0;
  width: 2px;
  background: linear-gradient(180deg, var(--red), var(--gold), var(--red));
}
.timeline-item {
  position: relative; padding: 1.5rem 0 1.5rem 2rem; border-bottom: 1px solid var(--border);
}
.timeline-item::before {
  content: '';
  position: absolute; left: -2rem; top: 50%; transform: translateY(-50%);
  width: 12px; height: 12px;
  background: var(--red); border: 2px solid var(--darker);
  border-radius: 50%;
}
.timeline-time { font-family: 'Share Tech Mono', monospace; color: var(--gold); font-size: 0.8rem; }
.timeline-title { font-size: 1.1rem; font-weight: 700; margin-top: 0.25rem; }
.timeline-desc { color: var(--muted); font-size: 0.9rem; margin-top: 0.25rem; }

/* PRIZES */
.prizes-grid {
  display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 2rem;
}
.prize-card {
  text-align: center; padding: 2rem;
  background: var(--panel); border: 1px solid var(--border);
  position: relative; overflow: hidden;
  transition: transform 0.3s;
}
.prize-card:hover { transform: translateY(-8px); }
.prize-card.gold { border-color: var(--gold); }
.prize-card.silver { border-color: #aaa; }
.prize-card.bronze { border-color: #cd7f32; }
.prize-card::before {
  content: '';
  position: absolute; top: 0; left: 0; right: 0; height: 3px;
}
.prize-card.gold::before { background: var(--gold); }
.prize-card.silver::before { background: #aaa; }
.prize-card.bronze::before { background: #cd7f32; }
.prize-pos {
  font-family: 'Orbitron', monospace; font-size: 3rem; font-weight: 900;
  line-height: 1;
}
.prize-card.gold .prize-pos { color: var(--gold); }
.prize-card.silver .prize-pos { color: #aaa; }
.prize-card.bronze .prize-pos { color: #cd7f32; }
.prize-label { font-size: 1.3rem; font-weight: 700; margin-top: 0.5rem; }
.prize-amount {
  font-family: 'Share Tech Mono', monospace;
  font-size: 1.5rem; color: var(--green);
  margin-top: 1rem;
}
.prize-perks { color: var(--muted); font-size: 0.85rem; margin-top: 0.5rem; line-height: 1.7; }

/* SPONSORS */
.sponsors-grid {
  display: flex; flex-wrap: wrap; justify-content: center; gap: 2rem; margin-top: 2rem;
}
.sponsor-badge {
  background: var(--panel); border: 1px solid var(--border);
  padding: 1rem 2rem;
  font-family: 'Orbitron', monospace; font-size: 0.9rem; font-weight: 700;
  color: var(--muted); letter-spacing: 2px;
  transition: all 0.2s;
}
.sponsor-badge:hover { color: var(--text); border-color: var(--red); }

/* FAQ */
.faq-list { display: flex; flex-direction: column; gap: 1px; }
.faq-item {
  background: var(--panel); border: 1px solid var(--border);
  overflow: hidden;
}
.faq-q {
  display: flex; justify-content: space-between; align-items: center;
  padding: 1.2rem 1.5rem; cursor: pointer;
  font-weight: 700; font-size: 1rem;
  transition: background 0.2s;
}
.faq-q:hover { background: rgba(227,0,34,0.05); }
.faq-q .icon {
  color: var(--red); font-size: 1.2rem;
  transition: transform 0.3s;
  font-family: monospace;
}
.faq-a {
  max-height: 0; overflow: hidden; transition: max-height 0.3s ease;
}
.faq-a.open { max-height: 200px; }
.faq-a p {
  padding: 0 1.5rem 1.2rem;
  color: var(--muted); line-height: 1.7; font-size: 0.95rem;
}

/* FOOTER */
footer {
  border-top: 1px solid var(--border);
  text-align: center; padding: 2rem;
  color: var(--muted); font-size: 0.85rem;
  font-family: 'Share Tech Mono', monospace;
  position: relative; z-index: 1;
}

@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ANNOUNCEMENT POPUP */
#announce-popup {
  position: fixed; bottom: 2rem; right: 2rem; z-index: 999;
  background: var(--panel); border: 1px solid var(--red);
  border-left: 4px solid var(--red); padding: 1.2rem 1.5rem;
  max-width: 320px; transform: translateX(400px);
  transition: transform 0.4s cubic-bezier(0.34,1.56,0.64,1);
  display: none;
}
#announce-popup.show { transform: translateX(0); display: block; }
#announce-popup .ann-title { font-weight: 700; color: var(--red); margin-bottom: 0.3rem; }
#announce-popup .ann-msg { color: var(--muted); font-size: 0.9rem; }
#announce-close { position: absolute; top: 0.5rem; right: 0.8rem; cursor: pointer; color: var(--muted); }

.separator {
  width: 60px; height: 2px;
  background: linear-gradient(90deg, var(--red), var(--gold));
  margin: 1rem auto;
}
</style>
</head>
<body>

<nav>
  <a href="/" class="nav-logo">CODE <span>GP</span></a>
  <div class="nav-links">
    <a href="#rules">Rules</a>
    <a href="#schedule">Schedule</a>
    <a href="#prizes">Prizes</a>
    <a href="#faq">FAQ</a>
    <a href="/leaderboard">Leaderboard</a>
    <a href="/login">Login</a>
    <a href="/register" class="btn-nav">Register</a>
  </div>
</nav>

<!-- HERO -->
<div class="hero">
  <div class="hero-bg"></div>
  <div class="speed-lines" id="speedLines"></div>
  <div class="hero-eyebrow">‚ö° SEASON 1 ¬∑ QUALIFICATION RACE</div>
  <h1 class="hero-title">
    <span class="line1">CODE</span>
    <span class="line2">GRAND</span>
    <span class="line3">PRIX 2024</span>
  </h1>
  <p class="hero-tagline">Race to the Algorithm ¬∑ Compete. Conquer. Champion.</p>
  <div class="hero-cta">
    <a href="/register" class="btn-primary">üèé Register Now</a>
    <a href="#rules" class="btn-secondary">View Rules</a>
  </div>

  <!-- Countdown -->
  <div class="countdown-section">
    <p class="countdown-label">‚è± Race Starts In</p>
    <div class="countdown-timer">
      <div class="countdown-unit">
        <div class="countdown-num" id="cd-days">00</div>
        <div class="countdown-unit-label">DAYS</div>
      </div>
      <div class="countdown-unit">
        <div class="countdown-num" id="cd-hours">00</div>
        <div class="countdown-unit-label">HOURS</div>
      </div>
      <div class="countdown-unit">
        <div class="countdown-num" id="cd-mins">00</div>
        <div class="countdown-unit-label">MINS</div>
      </div>
      <div class="countdown-unit">
        <div class="countdown-num" id="cd-secs">00</div>
        <div class="countdown-unit-label">SECS</div>
      </div>
    </div>
  </div>
</div>

<!-- RULES -->
<section id="rules">
  <div class="section-header">
    <div class="section-tag">// race_regulations.md</div>
    <h2 class="section-title">Rules & Guidelines</h2>
    <div class="separator"></div>
  </div>
  <div class="rules-grid">
    <div class="rule-card">
      <div class="rule-num">REG-01</div>
      <h3>Team Formation</h3>
      <p>Teams of 1-4 members. Create a team or join via invite code. All members must register before the race.</p>
    </div>
    <div class="rule-card">
      <div class="rule-num">REG-02</div>
      <h3>Submission Rules</h3>
      <p>Solutions are submitted via the code editor. Admin reviews and assigns points. No plagiarism tolerated.</p>
    </div>
    <div class="rule-card">
      <div class="rule-num">REG-03</div>
      <h3>Scoring System</h3>
      <p>Points awarded per problem based on difficulty. Bonus for First Blood. Penalty for wrong answers.</p>
    </div>
    <div class="rule-card">
      <div class="rule-num">REG-04</div>
      <h3>Languages Allowed</h3>
      <p>Python, C++, Java, JavaScript. Solutions must be original. External libraries are restricted.</p>
    </div>
    <div class="rule-card">
      <div class="rule-num">REG-05</div>
      <h3>Conduct</h3>
      <p>No internet assistance during contest. Disqualification for cheating. Admin decisions are final.</p>
    </div>
    <div class="rule-card">
      <div class="rule-num">REG-06</div>
      <h3>Grand Prix Points</h3>
      <p>Position-based bonus: 1st +50pts, 2nd +30pts, 3rd +20pts. Speed bonus for early solves applies.</p>
    </div>
  </div>
</section>

<!-- SCHEDULE -->
<section id="schedule">
  <div class="section-header">
    <div class="section-tag">// race_schedule.json</div>
    <h2 class="section-title">Race Schedule</h2>
    <div class="separator"></div>
  </div>
  <div class="timeline">
    <div class="timeline-item">
      <div class="timeline-time">PHASE 1</div>
      <div class="timeline-title">Registration & Team Formation</div>
      <div class="timeline-desc">Register individually, create teams, get approved by admin</div>
    </div>
    <div class="timeline-item">
      <div class="timeline-time">PHASE 2</div>
      <div class="timeline-title">Problem Release</div>
      <div class="timeline-desc">Problems across 6 categories released simultaneously</div>
    </div>
    <div class="timeline-item">
      <div class="timeline-time">PHASE 3</div>
      <div class="timeline-title">Main Race ‚Äî 3 Hours</div>
      <div class="timeline-desc">Solve, submit, climb the leaderboard. Real-time updates.</div>
    </div>
    <div class="timeline-item">
      <div class="timeline-time">PHASE 4</div>
      <div class="timeline-title">Leaderboard Freeze (Last 30 mins)</div>
      <div class="timeline-desc">Positions locked ‚Äî maintain suspense until ceremony</div>
    </div>
    <div class="timeline-item">
      <div class="timeline-time">PHASE 5</div>
      <div class="timeline-title">Award Ceremony & Podium</div>
      <div class="timeline-desc">Final results revealed. Certificates and badges distributed.</div>
    </div>
  </div>
</section>

<!-- PRIZES -->
<section id="prizes">
  <div class="section-header">
    <div class="section-tag">// prize_pool.json</div>
    <h2 class="section-title">Prize Details</h2>
    <div class="separator"></div>
  </div>
  <div class="prizes-grid">
    <div class="prize-card gold">
      <div class="prize-pos">ü•á</div>
      <div class="prize-label">POLE POSITION</div>
      <div class="prize-amount">‚Çπ10,000</div>
      <div class="prize-perks">Trophy + Certificate<br>Algorithm Master Badge<br>Internship Referral</div>
    </div>
    <div class="prize-card silver">
      <div class="prize-pos">ü•à</div>
      <div class="prize-label">2ND PLACE</div>
      <div class="prize-amount">‚Çπ5,000</div>
      <div class="prize-perks">Medal + Certificate<br>Speed Coder Badge<br>Goodies Kit</div>
    </div>
    <div class="prize-card bronze">
      <div class="prize-pos">ü•â</div>
      <div class="prize-label">3RD PLACE</div>
      <div class="prize-amount">‚Çπ2,500</div>
      <div class="prize-perks">Medal + Certificate<br>Debug King Badge<br>Sticker Pack</div>
    </div>
    <div class="prize-card" style="border-color: var(--red);">
      <div class="prize-pos" style="color: var(--red)">‚ö°</div>
      <div class="prize-label">FIRST BLOOD</div>
      <div class="prize-amount">BONUS</div>
      <div class="prize-perks">First to solve any problem<br>Special badge + 50 bonus pts<br>Hall of Fame entry</div>
    </div>
  </div>
</section>

<!-- SPONSORS -->
<section>
  <div class="section-header">
    <div class="section-tag">// sponsors.list</div>
    <h2 class="section-title">Our Sponsors</h2>
    <div class="separator"></div>
  </div>
  <div class="sponsors-grid">
    {% for s in sponsors %}
    <div class="sponsor-badge">{{ s }}</div>
    {% endfor %}
  </div>
</section>

<!-- FAQ -->
<section id="faq">
  <div class="section-header">
    <div class="section-tag">// faq.md</div>
    <h2 class="section-title">Frequently Asked Questions</h2>
    <div class="separator"></div>
  </div>
  <div class="faq-list">
    <div class="faq-item">
      <div class="faq-q" onclick="toggleFaq(this)">
        Who can participate? <span class="icon">+</span>
      </div>
      <div class="faq-a"><p>Any college student with a valid student email. Teams of 1-4 members. All skill levels welcome!</p></div>
    </div>
    <div class="faq-item">
      <div class="faq-q" onclick="toggleFaq(this)">
        How are solutions judged? <span class="icon">+</span>
      </div>
      <div class="faq-a"><p>You submit your solution via our code editor. Admin reviews correctness and assigns points. Results are reflected in real-time on your dashboard.</p></div>
    </div>
    <div class="faq-item">
      <div class="faq-q" onclick="toggleFaq(this)">
        What programming languages are allowed? <span class="icon">+</span>
      </div>
      <div class="faq-a"><p>Python, C++, Java, and JavaScript are supported in our code editor. Choose your weapon!</p></div>
    </div>
    <div class="faq-item">
      <div class="faq-q" onclick="toggleFaq(this)">
        Is internet access allowed during the contest? <span class="icon">+</span>
      </div>
      <div class="faq-a"><p>No. The contest is conducted under proctored conditions. Using external resources will lead to disqualification.</p></div>
    </div>
    <div class="faq-item">
      <div class="faq-q" onclick="toggleFaq(this)">
        How do penalties work? <span class="icon">+</span>
      </div>
      <div class="faq-a"><p>Each wrong submission adds 20 minutes to your penalty time. Teams with equal scores are ranked by lower penalty time.</p></div>
    </div>
    <div class="faq-item">
      <div class="faq-q" onclick="toggleFaq(this)">
        When are results announced? <span class="icon">+</span>
      </div>
      <div class="faq-a"><p>The leaderboard freezes for the last 30 minutes. Final results are unveiled at the award ceremony after the contest ends.</p></div>
    </div>
  </div>
</section>

<!-- REGISTER CTA -->
<section style="text-align: center; padding-bottom: 6rem;">
  <div class="section-tag">// ready_to_race.sh</div>
  <h2 class="section-title" style="margin: 0.5rem 0 2rem">Start Your Engine</h2>
  <div class="separator"></div>
  <p style="color: var(--muted); margin: 1.5rem 0 2rem; max-width: 500px; margin-left: auto; margin-right: auto; line-height: 1.8;">
    Register now, build your team, and prepare for the most intense algorithmic race of the semester.
  </p>
  <a href="/register" class="btn-primary">üèé Register for Free</a>
</section>

<footer>
  <p>CODE GRAND PRIX 2024 ¬∑ Built with ‚ö° ¬∑ Admin: <a href="/login" style="color: var(--red)">Login</a></p>
</footer>

<!-- Announce popup -->
<div id="announce-popup">
  <span id="announce-close" onclick="document.getElementById('announce-popup').classList.remove('show')">‚úï</span>
  <div class="ann-title" id="ann-title"></div>
  <div class="ann-msg" id="ann-msg"></div>
</div>

<script>
// Speed lines
const sl = document.getElementById('speedLines');
for (let i = 0; i < 8; i++) {
  const line = document.createElement('div');
  line.className = 'speed-line';
  line.style.cssText = `
    top: ${Math.random() * 100}%;
    width: ${20 + Math.random() * 40}%;
    animation-delay: ${Math.random() * 3}s;
    animation-duration: ${2 + Math.random() * 2}s;
  `;
  sl.appendChild(line);
}

// Countdown
function updateCountdown() {
  const startStr = '{{ settings.get("contest_start", "") }}';
  const start = new Date(startStr);
  const now = new Date();
  let diff = start - now;
  if (diff < 0) {
    document.querySelector('.countdown-label').textContent = '‚ö° Race is LIVE!';
    return;
  }
  const days = Math.floor(diff / 86400000); diff %= 86400000;
  const hours = Math.floor(diff / 3600000); diff %= 3600000;
  const mins = Math.floor(diff / 60000); diff %= 60000;
  const secs = Math.floor(diff / 1000);
  document.getElementById('cd-days').textContent = String(days).padStart(2,'0');
  document.getElementById('cd-hours').textContent = String(hours).padStart(2,'0');
  document.getElementById('cd-mins').textContent = String(mins).padStart(2,'0');
  document.getElementById('cd-secs').textContent = String(secs).padStart(2,'0');
}
setInterval(updateCountdown, 1000);
updateCountdown();

// FAQ toggle
function toggleFaq(el) {
  const ans = el.nextElementSibling;
  const icon = el.querySelector('.icon');
  ans.classList.toggle('open');
  icon.textContent = ans.classList.contains('open') ? '‚àí' : '+';
}

// Poll announcements
let lastAnnId = 0;
async function checkAnnouncements() {
  const res = await fetch('/api/announcements');
  const data = await res.json();
  if (data.length && data[0].id !== lastAnnId) {
    lastAnnId = data[0].id;
    document.getElementById('ann-title').textContent = data[0].title;
    document.getElementById('ann-msg').textContent = data[0].message;
    const popup = document.getElementById('announce-popup');
    popup.style.display = 'block';
    setTimeout(() => popup.classList.add('show'), 50);
    setTimeout(() => popup.classList.remove('show'), 8000);
  }
}
setInterval(checkAnnouncements, 30000);
</script>
</body>
</html>